<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Data from a Stochastic Network Epidemic Model — plot.netsim • EpiModel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Data from a Stochastic Network Epidemic Model — plot.netsim"><meta name="description" content="Plots epidemiological and network data from a stochastic network
model simulated with netsim."><meta property="og:description" content="Plots epidemiological and network data from a stochastic network
model simulated with netsim."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiModel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/attributes-and-summary-statistics.html">Working with Custom Attributes and Summary Statistics in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/Intro.html">EpiModel: Mathematical Modeling of Infectious Disease Dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/model-parameters.html">Working with Model Parameters in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/network-objects.html">Working with Network Objects in EpiModel</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EpiModel/EpiModel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Data from a Stochastic Network Epidemic Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/EpiModel/EpiModel/blob/main/R/plot.netsim.R" class="external-link"><code>R/plot.netsim.R</code></a></small>
      <div class="d-none name"><code>plot.netsim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots epidemiological and network data from a stochastic network
model simulated with <code><a href="netsim.html">netsim</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'netsim'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"epi"</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  popfrac <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sim.lines <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sim.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sim.lwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sim.alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mean.line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mean.smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mean.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mean.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mean.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  qnts <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  qnts.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qnts.alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  qnts.smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  leg.cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  network <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  at <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.status <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  shp.g2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vertex.cex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  targ.line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  targ.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  targ.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  targ.lty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  plots.joined <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  duration.imputed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <code>EpiModel</code> model object of class <code>netsim</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of plot: <code>"epi"</code> for epidemic model results,
<code>"network"</code> for a static network plot (<code>plot.network</code>),
or <code>"formation"</code>, <code>"duration"</code>, or <code>"dissolution"</code> for
network formation, duration, or dissolution statistics.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Output compartments or flows from <code>netsim</code> object to plot.</p></dd>


<dt id="arg-popfrac">popfrac<a class="anchor" aria-label="anchor" href="#arg-popfrac"></a></dt>
<dd><p>If <code>TRUE</code>, plot prevalence of values rather than numbers
(see details).</p></dd>


<dt id="arg-sim-lines">sim.lines<a class="anchor" aria-label="anchor" href="#arg-sim-lines"></a></dt>
<dd><p>If <code>TRUE</code>, plot individual simulation lines. Default is
to plot lines for one-group models but not for two-group models.</p></dd>


<dt id="arg-sims">sims<a class="anchor" aria-label="anchor" href="#arg-sims"></a></dt>
<dd><p>If <code>type="epi"</code> or <code>"formation"</code>, a vector of
simulation numbers to plot. If <code>type="network"</code>, a single
simulation number for which to plot the network, or else <code>"min"</code>
to plot the simulation number with the lowest disease prevalence,
<code>"max"</code> for the simulation with the highest disease prevalence,
or <code>"mean"</code> for the simulation with the prevalence closest to the
mean across simulations at the specified time step.</p></dd>


<dt id="arg-sim-col">sim.col<a class="anchor" aria-label="anchor" href="#arg-sim-col"></a></dt>
<dd><p>Vector of any standard R color format for simulation lines.</p></dd>


<dt id="arg-sim-lwd">sim.lwd<a class="anchor" aria-label="anchor" href="#arg-sim-lwd"></a></dt>
<dd><p>Line width for simulation lines.</p></dd>


<dt id="arg-sim-alpha">sim.alpha<a class="anchor" aria-label="anchor" href="#arg-sim-alpha"></a></dt>
<dd><p>Transparency level for simulation lines, where
0 = transparent and 1 = opaque (see <code>adjustcolor</code> function).</p></dd>


<dt id="arg-mean-line">mean.line<a class="anchor" aria-label="anchor" href="#arg-mean-line"></a></dt>
<dd><p>If <code>TRUE</code>, plot mean of simulations across time.</p></dd>


<dt id="arg-mean-smooth">mean.smooth<a class="anchor" aria-label="anchor" href="#arg-mean-smooth"></a></dt>
<dd><p>If <code>TRUE</code>, use a loess smoother on the mean line.</p></dd>


<dt id="arg-mean-col">mean.col<a class="anchor" aria-label="anchor" href="#arg-mean-col"></a></dt>
<dd><p>Vector of any standard R color format for mean lines.</p></dd>


<dt id="arg-mean-lwd">mean.lwd<a class="anchor" aria-label="anchor" href="#arg-mean-lwd"></a></dt>
<dd><p>Line width for mean lines.</p></dd>


<dt id="arg-mean-lty">mean.lty<a class="anchor" aria-label="anchor" href="#arg-mean-lty"></a></dt>
<dd><p>Line type for mean lines.</p></dd>


<dt id="arg-qnts">qnts<a class="anchor" aria-label="anchor" href="#arg-qnts"></a></dt>
<dd><p>If numeric, plot polygon of simulation quantiles based on the
range implied by the argument (see details). If <code>FALSE</code>, suppress
polygon from plot.</p></dd>


<dt id="arg-qnts-col">qnts.col<a class="anchor" aria-label="anchor" href="#arg-qnts-col"></a></dt>
<dd><p>Vector of any standard R color format for polygons.</p></dd>


<dt id="arg-qnts-alpha">qnts.alpha<a class="anchor" aria-label="anchor" href="#arg-qnts-alpha"></a></dt>
<dd><p>Transparency level for quantile polygons, where 0 =
transparent and 1 = opaque (see <code>adjustcolor</code> function).</p></dd>


<dt id="arg-qnts-smooth">qnts.smooth<a class="anchor" aria-label="anchor" href="#arg-qnts-smooth"></a></dt>
<dd><p>If <code>TRUE</code>, use a loess smoother on quantile polygons.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>If <code>TRUE</code>, plot default legend.</p></dd>


<dt id="arg-leg-cex">leg.cex<a class="anchor" aria-label="anchor" href="#arg-leg-cex"></a></dt>
<dd><p>Legend scale size.</p></dd>


<dt id="arg-grid">grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p>If <code>TRUE</code>, a grid is added to the background of plot
(see <code><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></code> for details), with default of nx by ny.</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>If <code>TRUE</code>, new plot window is not called and lines are added
to existing plot window.</p></dd>


<dt id="arg-network">network<a class="anchor" aria-label="anchor" href="#arg-network"></a></dt>
<dd><p>Network number, for simulations with multiple networks
representing the population.</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>If <code>type = "network"</code>, time step for network graph.</p></dd>


<dt id="arg-col-status">col.status<a class="anchor" aria-label="anchor" href="#arg-col-status"></a></dt>
<dd><p>If <code>TRUE</code> and <code>type="network"</code>, automatic disease
status colors (blue = susceptible, red = infected, green = recovered).</p></dd>


<dt id="arg-shp-g-">shp.g2<a class="anchor" aria-label="anchor" href="#arg-shp-g-"></a></dt>
<dd><p>If <code>type = "network"</code> and <code>x</code> is for a two-group model,
shapes for the Group 2 vertices, with acceptable inputs of "triangle"
and "square". Group 1 vertices will remain circles.</p></dd>


<dt id="arg-vertex-cex">vertex.cex<a class="anchor" aria-label="anchor" href="#arg-vertex-cex"></a></dt>
<dd><p>Relative size of plotted vertices if <code>type="network"</code>,
with implicit default of 1.</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>If <code>type="formation","duration","dissolution"</code>, statistics
to plot. For <code>type = "formation"</code>, <code>stats</code> are among those
specified in <code>nwstats.formula</code> of <code><a href="control.net.html">control.net</a></code>; for
<code>type = "duration", "dissolution"</code>, <code>stats</code> are among those
of the dissolution model (without <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset()</a></code>). The default is
to plot all statistics.</p></dd>


<dt id="arg-targ-line">targ.line<a class="anchor" aria-label="anchor" href="#arg-targ-line"></a></dt>
<dd><p>If <code>TRUE</code>, plot target or expected value line for
the statistic of interest.</p></dd>


<dt id="arg-targ-col">targ.col<a class="anchor" aria-label="anchor" href="#arg-targ-col"></a></dt>
<dd><p>Vector of standard R colors for target statistic lines, with
default colors based on <code>RColorBrewer</code> color palettes.</p></dd>


<dt id="arg-targ-lwd">targ.lwd<a class="anchor" aria-label="anchor" href="#arg-targ-lwd"></a></dt>
<dd><p>Line width for the line showing the target statistic values.</p></dd>


<dt id="arg-targ-lty">targ.lty<a class="anchor" aria-label="anchor" href="#arg-targ-lty"></a></dt>
<dd><p>Line type for the line showing the target statistic values.</p></dd>


<dt id="arg-plots-joined">plots.joined<a class="anchor" aria-label="anchor" href="#arg-plots-joined"></a></dt>
<dd><p>If <code>TRUE</code> and
<code>type="formation","duration","dissolution"</code>, combine all
statistics in one plot, versus one plot per statistic if
<code>FALSE</code>.</p></dd>


<dt id="arg-duration-imputed">duration.imputed<a class="anchor" aria-label="anchor" href="#arg-duration-imputed"></a></dt>
<dd><p>If <code>type = "duration"</code>, a logical indicating
whether or not to impute starting times for relationships extant at
the start of the simulation. Defaults to <code>TRUE</code> when
<code>type = "duration"</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Plot method for <code>type="formation", "duration", "dissolution"</code>,
with options of <code>"l"</code> for line plots and <code>"b"</code> for box plots.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>a main title for the plot, see also <code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></code>.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>the x limits (x1, x2) of the plot.  Note that <code>x1 &gt; x2</code>
    is allowed and leads to a ‘reversed axis’.</p>
<p>The default value, <code>NULL</code>, indicates that the range of the
    <a href="https://rdrr.io/r/base/is.finite.html" class="external-link">finite</a> values to be plotted should be used.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>a label for the x axis, defaults to a description of <code>x</code>.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>the y limits of the plot.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>a label for the y axis, defaults to a description of <code>y</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to pass.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This plot function can produce three types of plots with a stochastic network
model simulated through <code><a href="netsim.html">netsim</a></code>:</p><ol><li><p><strong><code>type="epi"</code></strong>: epidemic model results (e.g., disease
prevalence and incidence) may be plotted.</p></li>
<li><p><strong><code>type="network"</code></strong>: a static network plot will be
generated. A static network plot of a dynamic network is a
cross-sectional extraction of that dynamic network at a specific
time point. This plotting function wraps the
<code><a href="https://rdrr.io/pkg/network/man/plot.network.html" class="external-link">network::plot.network</a></code> function in the <code>network</code> package.
Consult the help page for <code>plot.network</code> for all of the plotting
parameters. In addition, four plotting parameters specific to
<code>netsim</code> plots are available: <code>sim</code>, <code>at</code>,
<code>col.status</code>, and <code>shp.g2</code>.</p></li>
<li><p><strong><code>type="formation"</code></strong>: summary network statistics related
to the network model formation are plotted. These plots are similar
to the formation plots for <code>netdx</code> objects. When running a
<code>netsim</code> simulation, one must specify there that
<code>save.nwstats=TRUE</code>; the plot here will then show the network
statistics requested explicitly in <code>nwstats.formula</code>, or will use
the formation formula set in <code>netest</code> otherwise.</p></li>
<li><p><strong><code>type="duration","dissolution"</code></strong>: as in
<code><a href="plot.netdx.html">plot.netdx</a></code>; supported in <code>plot.netsim</code> only when
the dissolution model is <code>~offset(edges)</code>, <code>tergmLite</code> is
<code>FALSE</code>, and <code>save.network</code> is <code>TRUE</code>.</p></li>
</ol><p>When <code>type="epi"</code>, this plotting function will extract the
epidemiological output from a model object of class <code>netsim</code> and plot
the time series data of disease prevalence and other results. The summary
statistics that the function calculates and plots are individual simulation
lines, means of the individual simulation lines, and quantiles of those
individual simulation lines. The mean line, toggled on with
<code>mean.line=TRUE</code>, is calculated as the row mean across simulations at
each time step.</p>
<p>Compartment prevalences are the size of a compartment over some denominator.
To plot the raw numbers from any compartment, use <code>popfrac=FALSE</code>; this
is the default for any plots of flows. The <code>popfrac</code> parameter
calculates and plots the denominators of all specified compartments using
these rules: 1) for one-group models, the prevalence of any compartment is
the compartment size divided by the total population size; 2) for two-group
models, the prevalence of any compartment is the compartment size divided by
the group population size. For any prevalences that are not automatically
calculated, the <code><a href="mutate_epi.html">mutate_epi</a></code> function may be used to add new
variables to the <code>netsim</code> object to plot or analyze.</p>
<p>The quantiles show the range of outcome values within a certain specified
quantile range. By default, the interquartile range is shown: that is the
middle 50\<!-- % of the data. This is specified by \code{qnts=0.5}. To show the -->
middle 95\<!-- % of the data, specify \code{qnts=0.95}. To toggle off the polygons -->
where they are plotted by default, specify <code>qnts=FALSE</code>.</p>
<p>When <code>type="network"</code>, this function will plot cross sections of the
simulated networks at specified time steps. Because it is only possible to
plot one time step from one simulation at a time, it is necessary to enter
these in the <code>at</code> and <code>sims</code> parameters. To aid in visualizing
representative and extreme simulations at specific time steps, the
<code>sims</code> parameter may be set to <code>"mean"</code> to plot the simulation in
which the disease prevalence is closest to the average across all
simulations, <code>"min"</code> to plot the simulation in which the prevalence is
lowest, and <code>"max"</code> to plot the simulation in which the prevalence is
highest.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/network/man/plot.network.html" class="external-link">network::plot.network</a></code>, <code><a href="mutate_epi.html">mutate_epi</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## SI Model without Network Feedback</span></span></span>
<span class="r-in"><span><span class="co"># Initialize network and set network model parameters</span></span></span>
<span class="r-in"><span><span class="va">nw</span> <span class="op">&lt;-</span> <span class="fu"><a href="network_initialize.html">network_initialize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nw</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_vertex_attribute.html">set_vertex_attribute</a></span><span class="op">(</span><span class="va">nw</span>, <span class="st">"group"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formation</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">edges</span></span></span>
<span class="r-in"><span><span class="va">target.stats</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">coef.diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissolution_coefs.html">dissolution_coefs</a></span><span class="op">(</span>dissolution <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span>, duration <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate the network model</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="netest.html">netest</a></span><span class="op">(</span><span class="va">nw</span>, <span class="va">formation</span>, <span class="va">target.stats</span>, <span class="va">coef.diss</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting maximum pseudolikelihood estimation (MPLE):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Obtaining the responsible dyads.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evaluating the predictor and response matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Maximizing the pseudolikelihood.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished MPLE.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate the epidemic model</span></span></span>
<span class="r-in"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="param.net.html">param.net</a></span><span class="op">(</span>inf.prob <span class="op">=</span> <span class="fl">0.3</span>, inf.prob.g2 <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">init</span> <span class="op">&lt;-</span> <span class="fu"><a href="init.net.html">init.net</a></span><span class="op">(</span>i.num <span class="op">=</span> <span class="fl">10</span>, i.num.g2 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="control.net.html">control.net</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SI"</span>, nsteps <span class="op">=</span> <span class="fl">20</span>, nsims <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                       verbose <span class="op">=</span> <span class="cn">FALSE</span>, save.nwstats <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       nwstats.formula <span class="op">=</span> <span class="op">~</span><span class="va">edges</span> <span class="op">+</span> <span class="va">meandeg</span> <span class="op">+</span> <span class="va">concurrent</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="netsim.html">netsim</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">param</span>, <span class="va">init</span>, <span class="va">control</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot epidemic trajectory</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"epi"</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"epi"</span>, popfrac <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"epi"</span>, y <span class="op">=</span> <span class="st">"si.flow"</span>, qnts <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot static networks</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"network"</span>, vertex.cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Automatic coloring of infected nodes as red</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"network"</span>, main <span class="op">=</span> <span class="st">"Min Prev | Time 50"</span>,</span></span>
<span class="r-in"><span>     col.status <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fl">20</span>, sims <span class="op">=</span> <span class="st">"min"</span>, vertex.cex <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"network"</span>, main <span class="op">=</span> <span class="st">"Max Prev | Time 50"</span>,</span></span>
<span class="r-in"><span>     col.status <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="fl">20</span>, sims <span class="op">=</span> <span class="st">"max"</span>, vertex.cex <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Automatic shape by group number (circle = group 1)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"network"</span>, at <span class="op">=</span> <span class="fl">20</span>, col.status <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     shp.g2 <span class="op">=</span> <span class="st">"square"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"network"</span>, at <span class="op">=</span> <span class="fl">20</span>, col.status <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     shp.g2 <span class="op">=</span> <span class="st">"triangle"</span>, vertex.cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot formation statistics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"formation"</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"formation"</span>, plots.joined <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"formation"</span>, sims <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"formation"</span>, plots.joined <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>     stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"edges"</span>, <span class="st">"concurrent"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span>, type <span class="op">=</span> <span class="st">"formation"</span>, stats <span class="op">=</span> <span class="st">"meandeg"</span>,</span></span>
<span class="r-in"><span>     mean.lwd <span class="op">=</span> <span class="fl">1</span>, qnts.col <span class="op">=</span> <span class="st">"seagreen"</span>, mean.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.netsim-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Jenness, Steven M. Goodreau, Martina Morris, Adrien Le Guillou, Chad Klumb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

