<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get the Forward or Backward Reachable Nodes for a Set of Nodes — reachable-nodes • EpiModel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get the Forward or Backward Reachable Nodes for a Set of Nodes — reachable-nodes"><meta name="description" content="These functions return the Forward or Backward Reachable Nodes of a set of
nodes in a network over a time. Warning, these functions ignore nodes without
edges in the period of interest. See the Number of Nodes section for
details It is much faster than iterating
tsna::tPath. The distance between to each node can be back calculated
using the length of the reachable set at each time step and the fact that the
reachable sets are ordered by the time to arrival."><meta property="og:description" content="These functions return the Forward or Backward Reachable Nodes of a set of
nodes in a network over a time. Warning, these functions ignore nodes without
edges in the period of interest. See the Number of Nodes section for
details It is much faster than iterating
tsna::tPath. The distance between to each node can be back calculated
using the length of the reachable set at each time step and the fact that the
reachable sets are ordered by the time to arrival."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiModel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/attributes-and-summary-statistics.html">Working with Custom Attributes and Summary Statistics in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/Intro.html">EpiModel: Mathematical Modeling of Infectious Disease Dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/model-parameters.html">Working with Model Parameters in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/network-objects.html">Working with Network Objects in EpiModel</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EpiModel/EpiModel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get the Forward or Backward Reachable Nodes for a Set of Nodes</h1>
      <small class="dont-index">Source: <a href="https://github.com/EpiModel/EpiModel/blob/main/R/reachable.R" class="external-link"><code>R/reachable.R</code></a></small>
      <div class="d-none name"><code>reachable-nodes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions return the Forward or Backward Reachable Nodes of a set of
nodes in a network over a time. Warning, these functions ignore nodes without
edges in the period of interest. See the <code>Number of Nodes</code> section for
details It is much faster than iterating
<code><a href="https://rdrr.io/pkg/tsna/man/paths.html" class="external-link">tsna::tPath</a></code>. The distance between to each node can be back calculated
using the length of the reachable set at each time step and the fact that the
reachable sets are ordered by the time to arrival.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_forward_reachable</span><span class="op">(</span></span>
<span>  <span class="va">el_cuml</span>,</span>
<span>  <span class="va">from_step</span>,</span>
<span>  <span class="va">to_step</span>,</span>
<span>  nodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dense_optim <span class="op">=</span> <span class="st">"auto"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_backward_reachable</span><span class="op">(</span></span>
<span>  <span class="va">el_cuml</span>,</span>
<span>  <span class="va">from_step</span>,</span>
<span>  <span class="va">to_step</span>,</span>
<span>  nodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dense_optim <span class="op">=</span> <span class="st">"auto"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-el-cuml">el_cuml<a class="anchor" aria-label="anchor" href="#arg-el-cuml"></a></dt>
<dd><p>a cumulative edgelist object. That is a data.frame with at
least columns: head, tail, start and stop. Start and stop are inclusive.</p></dd>


<dt id="arg-from-step">from_step<a class="anchor" aria-label="anchor" href="#arg-from-step"></a></dt>
<dd><p>the beginning of the time period.</p></dd>


<dt id="arg-to-step">to_step<a class="anchor" aria-label="anchor" href="#arg-to-step"></a></dt>
<dd><p>the end of the time period.</p></dd>


<dt id="arg-nodes">nodes<a class="anchor" aria-label="anchor" href="#arg-nodes"></a></dt>
<dd><p>the subset of nodes to calculate the FRP for. (default = NULL,
all nodes)</p></dd>


<dt id="arg-dense-optim">dense_optim<a class="anchor" aria-label="anchor" href="#arg-dense-optim"></a></dt>
<dd><p>pre-process the adjacency list to speed up the
computations on dense networks. "auto" (default), enable the
optimisation when <code>n_edges &gt; n_nodes</code>. "yes" always enables and "no"
always disables. The overhead of the optimization is not worth it on
sparse networks.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list containing:
<code>reached</code>: the set of reachable nodes for each of the <code>nodes</code>.
<code>lengths</code>: A matrix of <code>length(nodes)</code> rows and one column per timestep + 1
with the length of the reachable set at each step from <code>from_step - 1</code>
to <code>to_step</code>. The first column is always one as the set of reachables
at the beginning is just the node itself.</p>
    </div>
    <div class="section level2">
    <h2 id="number-of-nodes">Number of Nodes<a class="anchor" aria-label="anchor" href="#number-of-nodes"></a></h2>


<p>To speed up the calculations and lower the memory usage, these functions
only take into account nodes with edges in the cumulative edgelist over the
period of interest. The nodes are identified in the <code>reached</code> and <code>lengths</code>
sublists by names (e.g. <code>node_1093</code>). Nodes without any edges are therefore
not calculated as the only node they reach is themselve (length of 1).
Take this fact into account when exploring the distribution of Forward
Reachable Paths for example. As the nodes with FRP == 1 are not in the
output.</p>
    </div>
    <div class="section level2">
    <h2 id="time-and-memory-use">Time and Memory Use<a class="anchor" aria-label="anchor" href="#time-and-memory-use"></a></h2>


<p>These functions may be used to efficiently calculate multiple sets of
reachable nodes. As cumulative edgelists are way smaller than full
<code>networkDynamic</code> objects, theses functions are suited for large and dense
networks.
Also, as long as the size of the <code>nodes</code> set is greater than 5, theses
functions are faster than iterating over <code><a href="https://rdrr.io/pkg/tsna/man/paths.html" class="external-link">tsna::tPath</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="displaying-progress">Displaying Progress<a class="anchor" aria-label="anchor" href="#displaying-progress"></a></h2>


<p>These functions are using the
<a href="https://progressr.futureverse.org/articles/progressr-intro.html" class="external-link">progressr package</a>
to display its progression. Use
<code>progressr::with_progress({ fwd_reach &lt;- get_forward_reachable(el, from = 1, to = 260) })</code>
to display the progress bar. Or see the
<a href="https://progressr.futureverse.org/articles/progressr-intro.html" class="external-link">progressr package</a>
for more information and customization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load a network dynamic object</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"nd_obj.Rds"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># convert it to a cumulative edgelist</span></span></span>
<span class="r-in"><span><span class="va">el_cuml</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_cumulative_edgelist.html">as_cumulative_edgelist</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sample 100 node indexes</span></span></span>
<span class="r-in"><span><span class="va">nnodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">el_cuml</span><span class="op">$</span><span class="va">head</span>, <span class="va">el_cuml</span><span class="op">$</span><span class="va">tail</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">nnodes</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `get_forward_reachable` uses steps [from_step, to_step] inclusive</span></span></span>
<span class="r-in"><span><span class="va">el_fwd</span> <span class="op">&lt;-</span> <span class="fu">get_forward_reachable</span><span class="op">(</span><span class="va">el_cuml</span>, <span class="fl">1</span>, <span class="fl">52</span>, <span class="va">nodes</span><span class="op">)</span><span class="op">[[</span><span class="st">"reached"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check if the results are consistent with `tsna::tPath`</span></span></span>
<span class="r-in"><span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">el_fwd</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">el_fwd</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">node</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">t_fwd</span> <span class="op">&lt;-</span> <span class="fu">tsna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tsna/man/paths.html" class="external-link">tPath</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">nd</span>, v <span class="op">=</span> <span class="va">node</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">52</span> <span class="op">+</span> <span class="fl">1</span>, <span class="co"># tPath works from [start, end) right exclusive</span></span></span>
<span class="r-in"><span>    direction <span class="op">=</span> <span class="st">"fwd"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">t_fwd_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">t_fwd</span><span class="op">$</span><span class="va">tdist</span> <span class="op">&lt;</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setequal</a></span><span class="op">(</span><span class="va">el_fwd</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">t_fwd_set</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Missmatch on node: "</span>, <span class="va">node</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Backward:</span></span></span>
<span class="r-in"><span><span class="va">el_bkwd</span> <span class="op">&lt;-</span> <span class="fu">get_backward_reachable</span><span class="op">(</span><span class="va">el_cuml</span>, <span class="fl">1</span>, <span class="fl">52</span>, nodes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">[[</span><span class="st">"reached"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">el_bkwd</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t_bkwd</span> <span class="op">&lt;-</span> <span class="fu">tsna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tsna/man/paths.html" class="external-link">tPath</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">nd</span>, v <span class="op">=</span> <span class="va">nodes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  start <span class="op">=</span> <span class="fl">1</span>, end <span class="op">=</span> <span class="fl">52</span> <span class="op">+</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  direction <span class="op">=</span> <span class="st">"bkwd"</span>, type <span class="op">=</span> <span class="st">"latest.depart"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t_bkwd_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">t_bkwd</span><span class="op">$</span><span class="va">tdist</span> <span class="op">&lt;</span> <span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setequal</a></span><span class="op">(</span><span class="va">el_bkwd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">t_bkwd_set</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Jenness, Steven M. Goodreau, Martina Morris, Adrien Le Guillou, Chad Klumb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

