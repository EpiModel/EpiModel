<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Dynamic Network Model Estimation — netest • EpiModel</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic Network Model Estimation — netest"><meta name="description" content="Estimates statistical network models using the exponential
random graph modeling (ERGM) framework with extensions for
dynamic/temporal models (STERGM)."><meta property="og:description" content="Estimates statistical network models using the exponential
random graph modeling (ERGM) framework with extensions for
dynamic/temporal models (STERGM)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiModel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/attributes-and-summary-statistics.html">Working with Custom Attributes and Summary Statistics in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/Intro.html">EpiModel: Mathematical Modeling of Infectious Disease Dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/model-parameters.html">Working with Model Parameters in EpiModel</a></li>
    <li><a class="dropdown-item" href="../articles/network-objects.html">Working with Network Objects in EpiModel</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EpiModel/EpiModel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dynamic Network Model Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/EpiModel/EpiModel/blob/main/R/netest.R" class="external-link"><code>R/netest.R</code></a></small>
      <div class="d-none name"><code>netest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates statistical network models using the exponential
random graph modeling (ERGM) framework with extensions for
dynamic/temporal models (STERGM).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">netest</span><span class="op">(</span></span>
<span>  <span class="va">nw</span>,</span>
<span>  <span class="va">formation</span>,</span>
<span>  <span class="va">target.stats</span>,</span>
<span>  <span class="va">coef.diss</span>,</span>
<span>  <span class="va">constraints</span>,</span>
<span>  coef.form <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edapprox <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set.control.ergm <span class="op">=</span> <span class="fu">control.ergm</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  set.control.tergm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tergm/man/control.tergm.html" class="external-link">control.tergm</a></span><span class="op">(</span>MCMC.maxchanges <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  set.control.ergm.ego <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nested.edapprox <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nw">nw<a class="anchor" aria-label="anchor" href="#arg-nw"></a></dt>
<dd><p>An object of class <code>network</code> or <code>egor</code>, with the latter
indicating an <code>ergm.ego</code> fit.</p></dd>


<dt id="arg-formation">formation<a class="anchor" aria-label="anchor" href="#arg-formation"></a></dt>
<dd><p>Right-hand sided STERGM formation formula in the form
<code>~edges + ...</code>, where <code>...</code> are additional network statistics.</p></dd>


<dt id="arg-target-stats">target.stats<a class="anchor" aria-label="anchor" href="#arg-target-stats"></a></dt>
<dd><p>Vector of target statistics for the formation model, with
one number for each network statistic in the model. Ignored if
fitting via <code>ergm.ego</code>.</p></dd>


<dt id="arg-coef-diss">coef.diss<a class="anchor" aria-label="anchor" href="#arg-coef-diss"></a></dt>
<dd><p>An object of class <code>disscoef</code> output from the
<code><a href="dissolution_coefs.html">dissolution_coefs</a></code> function.</p></dd>


<dt id="arg-constraints">constraints<a class="anchor" aria-label="anchor" href="#arg-constraints"></a></dt>
<dd><p>Right-hand sided formula specifying constraints for the
modeled network, in the form <code>~...</code>, where <code>...</code> are
constraint terms. By default, no constraints are set.</p></dd>


<dt id="arg-coef-form">coef.form<a class="anchor" aria-label="anchor" href="#arg-coef-form"></a></dt>
<dd><p>Vector of coefficients for the offset terms in the formation
formula.</p></dd>


<dt id="arg-edapprox">edapprox<a class="anchor" aria-label="anchor" href="#arg-edapprox"></a></dt>
<dd><p>If <code>TRUE</code>, use the indirect edges dissolution
approximation  method for the dynamic model fit, otherwise use the
more time-intensive full STERGM estimation (see details).  For
<code>nw</code> of class <code>egor</code>, only <code>edapprox = TRUE</code> is supported.</p></dd>


<dt id="arg-set-control-ergm">set.control.ergm<a class="anchor" aria-label="anchor" href="#arg-set-control-ergm"></a></dt>
<dd><p>Control arguments passed to <code>ergm</code> (see details).</p></dd>


<dt id="arg-set-control-tergm">set.control.tergm<a class="anchor" aria-label="anchor" href="#arg-set-control-tergm"></a></dt>
<dd><p>Control arguments passed to <code>tergm</code> (see details).</p></dd>


<dt id="arg-set-control-ergm-ego">set.control.ergm.ego<a class="anchor" aria-label="anchor" href="#arg-set-control-ergm-ego"></a></dt>
<dd><p>Control arguments passed to <code>ergm.ego</code> (see
details).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, print model fitting progress to console.</p></dd>


<dt id="arg-nested-edapprox">nested.edapprox<a class="anchor" aria-label="anchor" href="#arg-nested-edapprox"></a></dt>
<dd><p>Logical. If <code>edapprox = TRUE</code> the dissolution
model is an initial segment of the formation model (see details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to other functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A fitted network model object of class <code>netest</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>netest</code> is a wrapper function for the <code>ergm</code>, <code>ergm.ego</code>, and <code>tergm</code>
functions that estimate static and dynamic network models. Network model
estimation is the first step in simulating a stochastic network epidemic model
in <code>EpiModel</code>. The output from <code>netest</code> is a necessary input for running the
epidemic simulations in <code><a href="netsim.html">netsim</a></code>. With a fitted network model, one should
always first proceed to model diagnostics, available through the <code><a href="netdx.html">netdx</a></code>
function, to check model fit. A detailed description of fitting these
models, along with examples, may be found in the
<a href="https://epimodel.github.io/sismid/" class="external-link">Network Modeling for Epidemics</a>
tutorials.</p>
    </div>
    <div class="section level2">
    <h2 id="edges-dissolution-approximation">Edges Dissolution Approximation<a class="anchor" aria-label="anchor" href="#edges-dissolution-approximation"></a></h2>


<p>The edges dissolution approximation method is described in Carnegie et al.
This approximation requires that the dissolution coefficients are known, that
the formation model is being fit to cross-sectional data conditional on those
dissolution coefficients, and that the terms in the dissolution model are a
subset of those in the formation model. Under certain additional conditions,
the formation coefficients of a STERGM model are approximately equal to the
coefficients of that same model fit to the observed cross-sectional data as
an ERGM, minus the corresponding coefficients in the dissolution model. The
approximation thus estimates this ERGM (which is typically much faster than
estimating a STERGM) and subtracts the dissolution coefficients.</p>
<p>The conditions under which this approximation best hold are when there are
few relational changes from one time step to another; i.e. when either
average relational durations are long, or density is low, or both.
Conveniently, these are the same conditions under which STERGM estimation is
slowest. Note that the same approximation is also used to obtain starting
values for the STERGM estimate when the latter is being conducted. The
estimation does not allow for calculation of standard errors, p-values, or
likelihood for the formation model; thus, this approach is of most use when
the main goal of estimation is to drive dynamic network simulations rather
than to conduct inference on the formation model. The user is strongly
encouraged to examine the behavior of the resulting simulations to confirm
that the approximation is adequate for their purposes. For an example, see
the vignette for the package <code>tergm</code>.</p>
<p>It has recently been found that subtracting a modified version of the
dissolution coefficients from the formation coefficients provides a more
principled approximation, and this is now the form of the approximation
applied by <code>netest</code>. The modified values subtracted from the formation
coefficients are equivalent to the (crude) dissolution coefficients with
their target durations increased by 1. The <code>nested.edapprox</code> argument
toggles whether to implement this modified version by appending the
dissolution terms to the formation model and appending the relevant values to
the vector of formation model coefficients (value = <code>FALSE</code>), whereas
the standard version subtracts the relevant values from the initial formation
model coefficients (value = <code>TRUE</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="control-arguments">Control Arguments<a class="anchor" aria-label="anchor" href="#control-arguments"></a></h2>


<p>The <code>ergm</code>, <code>ergm.ego</code>, and <code>tergm</code> functions allow control settings for the
model fitting process. When fitting a STERGM directly (setting
<code>edapprox</code> to <code>FALSE</code>), control parameters may be passed to the
<code>tergm</code> function with the <code>set.control.tergm</code> argument in <code>netest</code>.
The controls should be input through the <code><a href="https://rdrr.io/pkg/tergm/man/control.tergm.html" class="external-link">control.tergm()</a></code> function,
with the available parameters listed in the <code><a href="https://rdrr.io/pkg/tergm/man/control.tergm.html" class="external-link">tergm::control.tergm</a></code> help
page in the <code>tergm</code> package.</p>
<p>When fitting a STERGM indirectly (setting <code>edapprox</code> to <code>TRUE</code>), control
settings may be passed to the <code>ergm</code> function using <code>set.control.ergm</code>,
or to the <code>ergm.ego</code> function using <code>set.control.ergm.ego</code>. The controls
should be input through the <code>control.ergm()</code> and <code>control.ergm.ego()</code>
functions, respectively, with the available parameters listed in the
<code><a href="https://rdrr.io/pkg/ergm/man/control.ergm.html" class="external-link">ergm::control.ergm</a></code> help page in the <code>ergm</code> package and the
<code><a href="https://rdrr.io/pkg/ergm.ego/man/control.ergm.ego.html" class="external-link">ergm.ego::control.ergm.ego</a></code> help page in the <code>ergm.ego</code>
package. An example is below.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Krivitsky PN, Handcock MS. "A Separable Model for Dynamic Networks." JRSS(B).
2014; 76.1: 29-46.</p>
<p>Carnegie NB, Krivitsky PN, Hunter DR, Goodreau SM. An Approximation Method
for Improving Dynamic Network Model Fitting. Journal of Computational and
Graphical Statistics. 2014; 24(2): 502-519.</p>
<p>Jenness SM, Goodreau SM and Morris M. EpiModel: An R Package for Mathematical
Modeling of Infectious Disease over Networks. Journal of Statistical
Software. 2018; 84(8): 1-47.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Use <code><a href="netdx.html">netdx</a></code> to diagnose the fitted network model, and <code><a href="netsim.html">netsim</a></code>
to simulate epidemic spread over a simulated dynamic network
consistent with the model fit.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Initialize a network of 100 nodes</span></span></span>
<span class="r-in"><span><span class="va">nw</span> <span class="op">&lt;-</span> <span class="fu"><a href="network_initialize.html">network_initialize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set formation formula</span></span></span>
<span class="r-in"><span><span class="va">formation</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="va">edges</span> <span class="op">+</span> <span class="va">concurrent</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set target statistics for formation</span></span></span>
<span class="r-in"><span><span class="va">target.stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtain the offset coefficients</span></span></span>
<span class="r-in"><span><span class="va">coef.diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="dissolution_coefs.html">dissolution_coefs</a></span><span class="op">(</span>dissolution <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span>, duration <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate the STERGM using the edges dissolution approximation</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">netest</span><span class="op">(</span><span class="va">nw</span>, <span class="va">formation</span>, <span class="va">target.stats</span>, <span class="va">coef.diss</span>,</span></span>
<span class="r-in"><span>              set.control.ergm <span class="op">=</span> <span class="fu">control.ergm</span><span class="op">(</span>MCMC.burnin <span class="op">=</span> <span class="fl">1e5</span>,</span></span>
<span class="r-in"><span>                                              MCMC.interval <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting maximum pseudolikelihood estimation (MPLE):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Obtaining the responsible dyads.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evaluating the predictor and response matrix.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Maximizing the pseudolikelihood.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished MPLE.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting Monte Carlo maximum likelihood estimation (MCMLE):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 1 of at most 60:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>‘glpk’ selected as the solver, but package ‘Rglpk’ is not available; falling back to ‘lpSolveAPI’. This should be fine unless the sample size and/or the number of parameters is very big.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimizing with step length 1.0000.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The log-likelihood improved by 0.2794.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating equations are not within tolerance region.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration 2 of at most 60:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimizing with step length 1.0000.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The log-likelihood improved by 0.0136.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Convergence test p-value: &lt; 0.0001. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged with 99% confidence.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finished MCMLE.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This model was fit using MCMC.  To examine model diagnostics and check</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> for degeneracy, use the mcmc.diagnostics() function.</span>
<span class="r-in"><span><span class="va">est</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EpiModel Network Estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =======================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model class: netest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation Method: ERGM with Edges Approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Form</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formation: ~edges + concurrent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x560dd5bd4eb0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Target Statistics: 50 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints: ~.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dissolution: ~offset(edges)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Target Statistics: 10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To estimate the STERGM directly, use edapprox = FALSE</span></span></span>
<span class="r-in"><span><span class="co"># est2 &lt;- netest(nw, formation, target.stats, coef.diss, edapprox = FALSE)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Jenness, Steven M. Goodreau, Martina Morris, Adrien Le Guillou, Chad Klumb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

